{% extends 'base.html' %}
{% block content %}

<div class="container">
    <textarea name="" id="chat-log" cols="100" rows="20"></textarea><br>
</div>
<script>
    username = "{{ username }}"
    var chatSocket = new WebSocket(
        'ws://' + window.location.host + 
        '/ws/test/'+username+'/'
        )
        chatSocket.onmessage = function(e){
            console.log(e)
            var data = JSON.parse(e.data)
            var message = data('message')
            document.querySelector('#chat-log').value += (message + '\n')
        }
        chatSocket.onopen = function(e){
            console.log("연결 성공")
        }
        chatSocket.onclose = function(e){
            console.error('Chat Socket closed unexpectedly')
        }


</script>




{% endblock %}